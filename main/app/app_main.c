/**
 * @file app_main.c
 * @copyright Urheberrecht 2018-2023 ESoPe GmbH, Alle Rechte vorbehalten
 */
#include <stdio.h>
#include <string.h>
#include "module/comm/dbg.h"
#include "module/gui/eve_ui/screen.h"
#include "module/version/version.h"
#include "../board/board.h"
#include "freertos/FreeRTOS.h"
#include "freertos/task.h"
#include "screen_demo.h"

//-----------------------------------------------------------------------------------------------------------------------------------------------------------
// Internal definitions
//-----------------------------------------------------------------------------------------------------------------------------------------------------------


//-----------------------------------------------------------------------------------------------------------------------------------------------------------
// Internal structures and enums
//-----------------------------------------------------------------------------------------------------------------------------------------------------------


//-----------------------------------------------------------------------------------------------------------------------------------------------------------
// Prototypes
//-----------------------------------------------------------------------------------------------------------------------------------------------------------

//-----------------------------------------------------------------------------------------------------------------------------------------------------------
// Internal variables
//-----------------------------------------------------------------------------------------------------------------------------------------------------------
static screen_device_t _screen_device;

static screen_t		   _screen_demo;
//-----------------------------------------------------------------------------------------------------------------------------------------------------------
// External Functions
//-----------------------------------------------------------------------------------------------------------------------------------------------------------

void app_main_init(void)
{
	version_set(24000, 2);

	DBG_INFO("Init ESoPePlatformExample (Version %s [" __DATE__ " " __TIME__ "]). Urheberrecht 2018-2023 ESoPe GmbH, Alle Rechte vorbehalten\n", version_get_string());

	screen_device_config_t config = 
	{
		.hw = board_eve,
		.has_touch = true,
		.rotate = true,
		.type = EVE_DISPLAY_TYPE_ETML050023UDRA
	};

	FUNCTION_RETURN_T ret = screen_device_init(&_screen_device, &config);
	if(ret == FUNCTION_RETURN_OK)
	{
		screen_demo_init(&_screen_demo, &_screen_device);
		screen_paint(&_screen_demo, 0);
		screen_device_on(&_screen_device);
		screen_device_set_dimming(&_screen_device, 80);
	}

	DBG_INFO("Init finished\n");
}

#if SYSTEM_ENABLE_APP_MAIN_HANDLE
void app_main_handle(void)
{
	taskYIELD();
}
#endif

//-----------------------------------------------------------------------------------------------------------------------------------------------------------
// Internal Functions
//-----------------------------------------------------------------------------------------------------------------------------------------------------------
